<h1 id="verifying-password-sync-between-two-active-directory-domains-with-powershell">Verifying Password Sync Between Two Active Directory Domains with PowerShell</h1>

<p>In multi-domain or hybrid Active Directory environments, one common operational question comes up again and again:</p>

<blockquote>
  <p><strong>“Are passwords actually syncing between these two domains?”</strong></p>
</blockquote>

<p>Whether you’re using trust relationships, synchronization tools, or identity management solutions, a quick and reliable way to validate password synchronization is by comparing the <strong><code class="language-plaintext highlighter-rouge">PasswordLastSet</code></strong> timestamp for the same user across domains.</p>

<p>This post walks through how to write a <strong>PowerShell script</strong> that checks the password last set date and time between two domains and determines whether they are in sync.</p>

<hr />

<h2 id="why-passwordlastset">Why <code class="language-plaintext highlighter-rouge">PasswordLastSet</code>?</h2>

<p>Active Directory stores the time a user’s password was last changed in the attribute:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PasswordLastSet</span><span class="w">
</span></code></pre></div></div>

<p>If passwords are syncing correctly:</p>

<ul>
  <li>The timestamps should be <strong>identical</strong> or</li>
  <li>Within an <strong>acceptable time window</strong> (seconds or minutes, depending on your sync process)</li>
</ul>

<p>If they differ significantly, it’s a strong indicator of a sync issue.</p>

<hr />

<h2 id="prerequisites">Prerequisites</h2>

<p>Before you begin, ensure:</p>

<ul>
  <li>You have the <strong>ActiveDirectory PowerShell module</strong> installed</li>
  <li>You have <strong>read access</strong> to both domains</li>
  <li>DNS and trust relationships are correctly configured</li>
  <li>You know the <strong>domain controllers</strong> or domain names for both environments</li>
</ul>

<p>Import the module:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Import-Module</span><span class="w"> </span><span class="nx">ActiveDirectory</span><span class="w">
</span></code></pre></div></div>

<hr />

<h2 id="defining-the-domains">Defining the Domains</h2>

<p>For clarity, explicitly define the two domains you’re comparing.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$DomainA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"corp.domainA.local"</span><span class="w">
</span><span class="nv">$DomainB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"corp.domainB.local"</span><span class="w">
</span></code></pre></div></div>

<p>You can also specify particular domain controllers if needed:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$DC_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dc1.domainA.local"</span><span class="w">
</span><span class="nv">$DC_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dc1.domainB.local"</span><span class="w">
</span></code></pre></div></div>

<hr />

<h2 id="fetching-the-passwordlastset-value">Fetching the PasswordLastSet Value</h2>

<p>The following function retrieves the password last set timestamp for a given user in a specific domain:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">function</span><span class="w"> </span><span class="nf">Get-PasswordLastSet</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">param</span><span class="w"> </span><span class="p">(</span><span class="w">
        </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Username</span><span class="p">,</span><span class="w">
        </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Server</span><span class="w">
    </span><span class="p">)</span><span class="w">

    </span><span class="n">Get-ADUser</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nv">$Username</span><span class="w"> </span><span class="se">`
</span><span class="w">               </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$Server</span><span class="w"> </span><span class="se">`
</span><span class="w">               </span><span class="nt">-Properties</span><span class="w"> </span><span class="nx">PasswordLastSet</span><span class="w"> </span><span class="o">|</span><span class="w">
    </span><span class="n">Select-Object</span><span class="w"> </span><span class="nt">-ExpandProperty</span><span class="w"> </span><span class="nx">PasswordLastSet</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<hr />

<h2 id="comparing-password-timestamps-between-domains">Comparing Password Timestamps Between Domains</h2>

<p>Now let’s put it together.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$Username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jdoe"</span><span class="w">

</span><span class="nv">$PwdSetA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-PasswordLastSet</span><span class="w"> </span><span class="nt">-Username</span><span class="w"> </span><span class="nv">$Username</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$DomainA</span><span class="w">
</span><span class="nv">$PwdSetB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-PasswordLastSet</span><span class="w"> </span><span class="nt">-Username</span><span class="w"> </span><span class="nv">$Username</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$DomainB</span><span class="w">

</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Domain A PasswordLastSet: </span><span class="nv">$PwdSetA</span><span class="s2">"</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Domain B PasswordLastSet: </span><span class="nv">$PwdSetB</span><span class="s2">"</span><span class="w">
</span></code></pre></div></div>

<hr />

<h2 id="handling-time-differences-gracefully">Handling Time Differences Gracefully</h2>

<p>Exact timestamp matches aren’t always realistic. A small delay may be expected.</p>

<p>Here’s how to calculate the difference:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$TimeDifference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$PwdSetA</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">$PwdSetB</span><span class="p">)</span><span class="o">.</span><span class="nf">Duration</span><span class="p">()</span><span class="w">

</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$TimeDifference</span><span class="o">.</span><span class="nf">TotalMinutes</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"✅ Passwords appear to be in sync"</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"❌ Passwords are NOT in sync"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>You can adjust the threshold based on your environment’s sync behavior.</p>

<hr />

<h2 id="checking-multiple-users-at-once">Checking Multiple Users at Once</h2>

<p>To scale this check, you can loop through a list of users:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$Users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@(</span><span class="s2">"jdoe"</span><span class="p">,</span><span class="w"> </span><span class="s2">"asmith"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mbrown"</span><span class="p">)</span><span class="w">

</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$User</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$Users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-PasswordLastSet</span><span class="w"> </span><span class="nt">-Username</span><span class="w"> </span><span class="nv">$User</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$DomainA</span><span class="w">
    </span><span class="nv">$B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-PasswordLastSet</span><span class="w"> </span><span class="nt">-Username</span><span class="w"> </span><span class="nv">$User</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$DomainB</span><span class="w">

    </span><span class="nv">$Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$A</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">$B</span><span class="p">)</span><span class="o">.</span><span class="nf">Duration</span><span class="p">()</span><span class="w">

    </span><span class="p">[</span><span class="n">PSCustomObject</span><span class="p">]@{</span><span class="w">
        </span><span class="nx">User</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="w">
        </span><span class="nx">DomainA_LastSet</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">$A</span><span class="w">
        </span><span class="nx">DomainB_LastSet</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">$B</span><span class="w">
        </span><span class="nx">DifferenceMinutes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">math</span><span class="p">]</span><span class="err">::</span><span class="nx">Round</span><span class="err">(</span><span class="nv">$Diff</span><span class="err">.</span><span class="nx">TotalMinutes</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="err">)</span><span class="w">
        </span><span class="nx">InSync</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="err">(</span><span class="nv">$Diff</span><span class="err">.</span><span class="nx">TotalMinutes</span><span class="w"> </span><span class="err">-</span><span class="nx">le</span><span class="w"> </span><span class="mi">5</span><span class="err">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This produces clean, report-ready output.</p>

<hr />

<h2 id="common-gotchas">Common Gotchas</h2>

<h3 id="time-synchronization">Time Synchronization</h3>

<p>If domain controllers aren’t time-synced (NTP issues), your results may be misleading.</p>

<h3 id="password-writeback-delays">Password Writeback Delays</h3>

<p>Some sync solutions update attributes asynchronously—short mismatches may be normal.</p>

<h3 id="replication-latency">Replication Latency</h3>

<p>If you query different DCs, replication delays can cause temporary differences.</p>

<hr />

<h2 id="when-this-approach-works-best">When This Approach Works Best</h2>

<p>This method is ideal for:</p>

<ul>
  <li>Troubleshooting password sync issues</li>
  <li>Validating migrations</li>
  <li>Spot-checking identity synchronization</li>
  <li>Operational monitoring scripts</li>
</ul>

<p>It’s not a replacement for full identity monitoring—but it’s an excellent <strong>first diagnostic step</strong>.</p>

<hr />

<h2 id="final-thoughts">Final Thoughts</h2>

<p>PowerShell makes it easy to validate password synchronization using native Active Directory attributes. By comparing <code class="language-plaintext highlighter-rouge">PasswordLastSet</code> across domains, you gain a quick, reliable signal that helps confirm whether your identity infrastructure is behaving as expected.</p>

<p>Sometimes the simplest checks uncover the biggest problems.</p>

<hr />
