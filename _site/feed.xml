<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://ritchiecaruso.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://ritchiecaruso.com/" rel="alternate" type="text/html" /><updated>2026-01-01T15:02:53+11:00</updated><id>https://ritchiecaruso.com/feed.xml</id><title type="html">Ritchie Caruso</title><subtitle>A simple Jekyll site</subtitle><entry><title type="html">How Bad Actors Can Hide Outlook &amp;amp; Exchange Inbox Rules</title><link href="https://ritchiecaruso.com/2025/10/20/hidden-outlook-rules.html" rel="alternate" type="text/html" title="How Bad Actors Can Hide Outlook &amp;amp; Exchange Inbox Rules" /><published>2025-10-20T00:00:00+11:00</published><updated>2025-10-20T00:00:00+11:00</updated><id>https://ritchiecaruso.com/2025/10/20/hidden-outlook-rules</id><content type="html" xml:base="https://ritchiecaruso.com/2025/10/20/hidden-outlook-rules.html"><![CDATA[<p>It was a typical Monday morning. I sat down at my desk, ready to start the day, when I received a Microsoft Teams message from our cybersecurity department. Over the weekend, a breach had occurred that impacted several users.</p>

<p>Without going into sensitive detail, the attacker had gained access to user accounts and distributed a phishing campaign via a SharePoint file.</p>

<p>My task that morning was straightforward:</p>

<ul>
  <li>Assist affected users with password resets</li>
  <li>Ensure multi-factor authentication (MFA) using an authenticator app was configured</li>
  <li>Restore access to their accounts</li>
</ul>

<p>After working through this process with several users, I noticed a strange pattern: <strong>none of them had received any emails since Friday</strong>.</p>

<p>At first glance, this didn’t seem alarming — it <em>was</em> the weekend — but something felt off. I sent a test email to one of the accounts. It never appeared in the inbox.</p>

<p>After searching Outlook, I discovered the message had arrived successfully, but it was sitting in the <strong>Archive</strong> folder, along with every other email received since Friday.</p>

<p>At this point, it became clear that an inbox rule was involved. However, when I checked the Outlook <em>Rules and Alerts</em> interface, <strong>no rules were visible</strong>.</p>

<p>After further research, I found multiple reports describing similar behaviour. That’s when I learned about a little-known — but highly effective — technique that allows attackers to <strong>hide Outlook/Exchange inbox rules from the Rules GUI entirely</strong>.</p>

<p>In this post, I’ll walk through:</p>

<ul>
  <li>How this attack works</li>
  <li>How attackers hide inbox rules</li>
  <li>How to detect hidden rules</li>
  <li>How to remove them at scale across an organisation</li>
</ul>

<p><br /></p>

<h2 id="the-attack">The Attack</h2>

<h3 id="how-is-the-attack-executed">How Is the Attack Executed?</h3>
<figure>
  <img src="/assets/images/hidden-rules/hidden-rule-attack.webp" alt="Hidden Rule Attack Steps" width="250" />
  <figcaption>Hidden Rule Attack Steps</figcaption>
</figure>

<p>In our environment, external email forwarding was blocked. Instead of forwarding messages, the attacker created a rule that silently moved emails out of sight — buying time before the user realised their account had been compromised.</p>

<p>These actions are well suited to scripting and automation—particularly the creation of the malicious rule and the subsequent steps to conceal it from Outlook clients.</p>

<p>For simplicity, we’ll assume the attacker has already <strong>completed steps 1 and 2</strong>:</p>

<ol>
  <li>Obtained valid credentials</li>
  <li>Logged into the victim’s mailbox via Outlook</li>
</ol>

<p><br /></p>

<h3 id="step-3-create-a-malicious-inbox-rule">Step 3: Create a Malicious Inbox Rule</h3>

<p>The attacker creates an inbox rule that forwards or moves emails — for example, to the attackers email.</p>

<figure>
  <img src="/assets/images/hidden-rules/create-rule.png" alt="Creating Outlook rule" width="400" />
  <figcaption>Creating Outlook rule</figcaption>
</figure>

<p>At this stage, the rule is still visible in the <strong>Rules and Alerts</strong> window.</p>

<p><br /></p>

<h3 id="step-4-hide-the-rule">Step 4: Hide the Rule</h3>

<p>The next step is to make the rule nearly invisible.</p>

<p>This exploit abuses Microsoft’s <strong>Messaging API (MAPI)</strong>, a middleware layer that allows applications like Outlook to interact with mailbox data.</p>

<p>To demonstrate, I used <strong>MFCMapi</strong>, a Microsoft-provided diagnostic tool available on GitHub.</p>

<p>In this example, the rule moves emails with the subject <em>“Hidden Test”</em> to the Archive folder.</p>

<figure>
  <img src="/assets/images/hidden-rules/rule-demonstration.png" alt="Rule that will be hidden" width="400" />
  <figcaption>Rule that will be hidden</figcaption>
</figure>

<h4 id="hiding-the-rule-with-mfcmapi">Hiding the Rule with MFCMapi</h4>

<ol>
  <li>Open the Inbox in <strong>MFCMapi</strong></li>
  <li>Navigate to <strong>Folder → View → Hidden Contents</strong></li>
  <li>Locate messages with the class <code class="language-plaintext highlighter-rouge">IPM.Rule.Version2.Message</code></li>
  <li>Open the rule and locate the following properties:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">PR_RULE_MSG_NAME</code></li>
      <li><code class="language-plaintext highlighter-rouge">PR_RULE_MSG_PROVIDER</code></li>
    </ul>
  </li>
  <li><strong>Clear the value fields</strong> for both properties</li>
</ol>

<figure>
  <img src="/assets/images/hidden-rules/mfcmapi-changes.png" alt="Tampering with rule properties" width="600" />
  <figcaption>Tampering with rule properties</figcaption>
</figure>

<p>Once modified, the rule no longer appears in Outlook or standard administrative interfaces.</p>

<p><br /></p>

<h2 id="detecting-hidden-inbox-rules">Detecting Hidden Inbox Rules</h2>

<p>After hiding the rule, the <strong>Rules and Alerts</strong> window appears empty:</p>

<figure>
  <img src="/assets/images/hidden-rules/rule-is-hidden.png" alt="No rules visible in Outlook" width="600" />
  <figcaption>No rules visible in Outlook</figcaption>
</figure>

<p>However, the rule is still active.</p>

<p>After sending a test email that meets the rule’s criteria, the message is silently moved to the Archive folder:</p>

<figure>
  <img src="/assets/images/hidden-rules/email-in-archive.png" alt="Email moved by hidden rule" width="600" />
  <figcaption>Email moved by hidden rule</figcaption>
</figure>

<p><br /></p>

<h2 id="detecting-hidden-rules-with-powershell">Detecting Hidden Rules with PowerShell</h2>

<p>Manually inspecting mailboxes with MFCMapi does not scale. Fortunately, <strong>PowerShell provides visibility into hidden rules</strong>.</p>

<p>First, connect to Exchange Online:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Connect-ExchangeOnline</span><span class="w">
</span></code></pre></div></div>

<p>Then query inbox rules, including hidden ones:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Get-InboxRule</span><span class="w"> </span><span class="nt">-Mailbox</span><span class="w"> </span><span class="nx">example</span><span class="err">@</span><span class="nx">example.com</span><span class="w"> </span><span class="nt">-IncludeHidden</span><span class="w">
</span></code></pre></div></div>
<p>Hidden rules appear with a numeric string.</p>

<figure>
  <img src="/assets/images/hidden-rules/Get-InboxRule.png" alt="Detecting hidden rule in Powershell" width="600" />
  <figcaption>Detecting hidden rule in Powershell</figcaption>
</figure>

<p><br /></p>

<h2 id="removing-hidden-rules">Removing Hidden Rules</h2>
<p>There are two effective removal methods.</p>

<h3 id="option-1-powershell-recommended">Option 1: Powershell (Recommended)</h3>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Remove-InboxRule</span><span class="w"> </span><span class="nt">-Mailbox</span><span class="w"> </span><span class="nx">example</span><span class="err">@</span><span class="nx">work.com</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"RULE_ID"</span><span class="w">
</span></code></pre></div></div>

<figure>
  <img src="/assets/images/hidden-rules/remove-rule.png" alt="Removing hidden rule in Powershell" width="800" />
  <figcaption>Removing hidden rule in Powershell</figcaption>
</figure>

<h3 id="option-2-outlook-clean-rules-flag">Option 2: Outlook Clean Rules Flag</h3>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>outlook.exe /cleanrules
</code></pre></div></div>
<figure>
  <img src="/assets/images/hidden-rules/clean-rules.png" alt="Cleaning Outlook Rules" width="400" />
  <figcaption>Cleaning Outlook Rules</figcaption>
</figure>

<p>⚠️ Warning: This removes all inbox rules for the user.</p>

<p><br /></p>

<h2 id="scanning-the-entire-organisation">Scanning the Entire Organisation</h2>
<p>To ensure no hidden rules remain across the tenant, I wrote the following PowerShell script:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$mailboxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-EXOMailbox</span><span class="w"> </span><span class="nt">-ResultSize</span><span class="w"> </span><span class="nx">Unlimited</span><span class="w">
</span><span class="nv">$output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">

</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$mailbox</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$mailboxes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$hiddenrules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-InboxRule</span><span class="w"> </span><span class="nt">-Mailbox</span><span class="w"> </span><span class="nv">$mailbox</span><span class="w"> </span><span class="nt">-IncludeHidden</span><span class="w"> </span><span class="o">|</span><span class="w">
        </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="nt">-notin</span><span class="w"> </span><span class="p">(</span><span class="n">Get-InboxRule</span><span class="w"> </span><span class="nt">-Mailbox</span><span class="w"> </span><span class="nv">$mailbox</span><span class="p">)</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-and</span><span class="w">
            </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="s2">"Junk E-Mail Rule"</span><span class="w">
        </span><span class="p">}</span><span class="w">

    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$hiddenrules</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$rule</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$hiddenrules</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nv">$output</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[</span><span class="n">PSCustomObject</span><span class="p">]@{</span><span class="w">
                </span><span class="nx">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$mailbox</span><span class="err">.</span><span class="nx">UserPrincipalName</span><span class="w">
                </span><span class="nx">Rule</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">$rule</span><span class="err">.</span><span class="nx">Name</span><span class="w">
            </span><span class="p">}</span><span class="w">
            </span><span class="n">Write-Host</span><span class="w"> </span><span class="nv">$mailbox</span><span class="o">.</span><span class="nf">UserPrincipalName</span><span class="w"> </span><span class="nv">$rule</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Red</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$output</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Export-Csv</span><span class="w"> </span><span class="s2">"OUTPUT_PATH.csv"</span><span class="w"> </span><span class="nt">-NoTypeInformation</span><span class="w">
</span></code></pre></div></div>
<p>This produces a list of mailboxes with suspicious hidden rules.</p>

<p><br /></p>

<h2 id="inspecting-rule-behaviour">Inspecting Rule Behaviour</h2>
<p>To understand what a hidden rule actually does:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
</span><span class="nv">$rules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-InboxRule</span><span class="w"> </span><span class="nt">-Mailbox</span><span class="w"> </span><span class="s2">"EXCHANGE_EMAIL"</span><span class="w"> </span><span class="nt">-IncludeHidden</span><span class="w"> </span><span class="o">|</span><span class="w">
    </span><span class="n">Select-Object</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">Description</span><span class="w">

</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$rule</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$rules</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$rule</span><span class="o">.</span><span class="nf">Description</span><span class="w"> </span><span class="o">-replace</span><span class="w"> </span><span class="s2">"</span><span class="se">`r</span><span class="s2">?</span><span class="se">`n</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="s2">" "</span><span class="w">
    </span><span class="nv">$output</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">[</span><span class="n">PSCustomObject</span><span class="p">]@{</span><span class="w">
        </span><span class="nx">RuleName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$rule</span><span class="err">.</span><span class="nx">Name</span><span class="w">
        </span><span class="nx">RuleDesc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$desc</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$output</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Export-Csv</span><span class="w"> </span><span class="s2">"OUTPUT_PATH.csv"</span><span class="w"> </span><span class="nt">-NoTypeInformation</span><span class="w">
</span></code></pre></div></div>

<figure>
  <img src="/assets/images/hidden-rules/description-output.png" alt="Rule Description Output" width="1000" />
  <figcaption>Rule Description Output</figcaption>
</figure>
<p>This allows you to determine whether the rule is malicious or benign.</p>

<p><br /></p>

<h2 id="final-thoughts">Final Thoughts</h2>
<p>A compromised account cannot always be considered secure after a password reset and session token revocation alone.</p>

<p>Hidden inbox rules are a powerful persistence mechanism that can:</p>
<ul>
  <li>Suppress security alerts</li>
  <li>Hide user communications</li>
  <li>Enable long-term access to information without detection</li>
</ul>

<p>Microsoft does not currently classify this behaviour as a vulnerability, as it requires authenticated access. However, it is difficult to identify any legitimate use case for completely hiding inbox rules.</p>

<p>As a result of this incident, we now:</p>
<ul>
  <li>Periodically scan for hidden inbox rules</li>
  <li>Continue to restrict external email forwarding</li>
  <li>Complete an in-depth forensic investigation into any breaches</li>
</ul>

<p>What began as a routine Monday quickly turned into a deep investigation, remediation effort, and a reminder that mailbox persistence techniques can be subtle yet highly effective.</p>

<p>Stay vigilant — and don’t rely on the Rules GUI alone.</p>]]></content><author><name></name></author><category term="cybersecurity" /><category term="microsoft" /><category term="exchange" /><category term="outlook" /><category term="incident-response" /><summary type="html"><![CDATA[It was a typical Monday morning. I sat down at my desk, ready to start the day, when I received a Microsoft Teams message from our cybersecurity department. Over the weekend, a breach had occurred that impacted several users.]]></summary></entry><entry><title type="html">Why Build a Home Server in a Cloud-First World?</title><link href="https://ritchiecaruso.com/2023/11/10/nas-build.html" rel="alternate" type="text/html" title="Why Build a Home Server in a Cloud-First World?" /><published>2023-11-10T00:00:00+11:00</published><updated>2023-11-10T00:00:00+11:00</updated><id>https://ritchiecaruso.com/2023/11/10/nas-build</id><content type="html" xml:base="https://ritchiecaruso.com/2023/11/10/nas-build.html"><![CDATA[<p>Cloud computing is everywhere. It’s fast, convenient, and generally affordable. So why would anyone bother building their own server to store data and files?</p>

<p>For me, the answer came down to a few key reasons:</p>

<ul>
  <li><strong>Backing up and syncing across ecosystems</strong> (Apple and Google Photos in one place)</li>
  <li><strong>Data ownership and control</strong> — how secure is the platform you’re trusting?</li>
  <li><strong>Access files from any device</strong> — the biggest selling point of cloud storage</li>
  <li><strong>Learning and hands-on experience</strong> building and maintaining computers</li>
  <li><strong>Endless possibilities</strong> beyond basic storage: VMs, Home Assistant, Pi-hole, Docker, and more</li>
</ul>

<p>With those goals in mind, I decided to build my own NAS (Network Attached Storage).</p>

<p><br /></p>

<h2 id="project-requirements">Project Requirements</h2>

<p>Before choosing hardware or software, I defined what I wanted this server to do:</p>

<ul>
  <li>Plenty of storage for photo backups</li>
  <li>Store personal files accessible from any device</li>
  <li>Enough power to run virtual machines and Docker containers</li>
  <li>RAID for redundancy, plus:
    <ul>
      <li>One separate onsite backup</li>
      <li>One offsite backup over VPN</li>
    </ul>
  </li>
  <li>A <strong>simple and minimal management interface</strong></li>
</ul>

<p><br /></p>

<h2 id="choosing-the-operating-system">Choosing the Operating System</h2>

<p>I narrowed my OS choices down to:</p>

<ul>
  <li>Unraid</li>
  <li>Proxmox</li>
  <li>TrueNAS</li>
</ul>

<p>While all three are solid options, I chose <strong>Unraid</strong>. The deciding factor was simplicity. I wanted this NAS to be easy to manage, without constantly tweaking or babysitting it. (Unraid did require a one off cost around $80 after the generous trial period.)</p>

<p><br /></p>

<h2 id="hardware-parts-list">Hardware Parts List</h2>

<p>Here’s the hardware I used for the build:</p>

<table>
  <thead>
    <tr>
      <th>Component</th>
      <th>Price (AUD)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>AMD Ryzen 5 5600G CPU</td>
      <td>$199</td>
    </tr>
    <tr>
      <td>Asus Prime B450M-A II Motherboard</td>
      <td>$119</td>
    </tr>
    <tr>
      <td>Corsair Vengeance RGB PRO 16GB RAM (spare)</td>
      <td>~$100</td>
    </tr>
    <tr>
      <td>Be Quiet! Dark Rock TF2 CPU Cooler (spare)</td>
      <td>~$120</td>
    </tr>
    <tr>
      <td>650W Non-modular PSU (spare)</td>
      <td>~$70</td>
    </tr>
    <tr>
      <td>Fractal Design Node 804 Case</td>
      <td>$199</td>
    </tr>
    <tr>
      <td>SilverStone ECS06 6-Port PCIe SATA Controller</td>
      <td>$105</td>
    </tr>
    <tr>
      <td>8× 2TB Enterprise HDDs (10+ years old)</td>
      <td>Free</td>
    </tr>
  </tbody>
</table>

<p><strong>Total:</strong> ~<strong>$900 AUD (excluding storage)</strong></p>

<p>The drives were donated to me instead of being thrown out due to their age — a great way to keep e-waste down and costs low.</p>

<p>Also note this image has some parts that were installed in my Personal PC, the parts from my Personal PC were then repurposed for the NAS.</p>

<figure>
  <img src="/assets/images/nas-blog/parts-list.webp" alt="NAS Build Parts" width="600" />
  <figcaption>NAS Build Parts</figcaption>
</figure>

<p><br /></p>

<h2 id="assembly-process">Assembly Process</h2>

<p>Once all the parts arrived, I removed the components from my personal PC that I planned to reuse and got started.</p>

<h3 id="case--cooling">Case &amp; Cooling</h3>

<p>The <strong>Fractal Node 804</strong> has a great layout with two separate chambers:</p>
<ul>
  <li>One for components</li>
  <li>One dedicated to storage</li>
</ul>

<p>It includes three fans out of the box. I removed the drive cages initially to make assembly easier.</p>

<h3 id="initial-boot-test">Initial Boot Test</h3>

<p>Before installing the motherboard into the case, I:</p>

<ul>
  <li>Installed the CPU</li>
  <li>Mounted the cooler</li>
  <li>Inserted RAM</li>
  <li>Connected power on the bench</li>
</ul>

<p>It booted into the BIOS on the first try — always a good feeling.</p>

<figure>
  <div class="side-by-side">
    <img src="/assets/images/nas-blog/bench-test.webp" alt="Bench Test Top View" />
    <img src="/assets/images/nas-blog/bench-side.webp" alt="Bench Test Side View" />
  </div>
  <figcaption>Bench Test</figcaption>
</figure>

<h3 id="final-assembly">Final Assembly</h3>

<p>After installing everything into the case:</p>

<ul>
  <li>Added extra spare fans for airflow (8 drives generate some extra heat)</li>
  <li>Installed all HDDs vertically in their cages</li>
  <li>Connected SATA and power cables</li>
  <li>Installed the PCIe SATA controller (the motherboard only supports 6 SATA ports)</li>
</ul>

<p>This setup leaves <strong>4 spare SATA ports</strong> for future expansion.</p>

<p>I didn’t include a dedicated GPU to keep power usage low. The Ryzen 5600G’s integrated graphics are more than sufficient for a NAS.</p>

<figure>
  <div class="side-by-side">
    <img src="/assets/images/nas-blog/case.webp" alt="Finished Build Case" />
    <img src="/assets/images/nas-blog/hdds.webp" alt="Finished Build Harddrives" />
  </div>
  <figcaption>Finished Build</figcaption>
</figure>

<p>I had to replace one of the Dell drives with a 2TB Seagate I had lying around due to one of the 8 Dell drives failing on boot.</p>

<p><br /></p>

<h2 id="installing-unraid">Installing Unraid</h2>

<p>Unraid runs entirely from a USB drive, which means all internal storage is available for data.</p>

<p>Installation was simple using the <strong>Unraid USB Flash Creator</strong>:</p>

<ul>
  <li>Selected server name</li>
  <li>Configured network settings</li>
  <li>Booted directly into Unraid</li>
</ul>

<p>I reserved an IP Address on my router for the NAS to ensure accessing the web GUI and file shares would be straightforward.</p>

<p><br /></p>

<h2 id="storage-configuration">Storage Configuration</h2>

<p>I configured the drives using <strong>RAID 6</strong>, which provides:</p>

<ul>
  <li>Double distributed parity</li>
  <li>Protection against <strong>up to two drive failures</strong></li>
</ul>

<p>Once the array was up and running, I:</p>

<ul>
  <li>Created file shares</li>
  <li>Installed plugins for hardware monitoring (CPU temps, drive health, etc.)</li>
</ul>

<p>Permissions were set on file shares to control access across devices and users. This allowed me to create shares that guests on the network could have access to while securing personal files with user credentials.</p>

<figure>
  <img src="/assets/images/nas-blog/array.webp" alt="RAID Configuration" width="600" />
  <figcaption>RAID Configuration</figcaption>
</figure>

<p><br /></p>

<h2 id="virtual-machines--docker">Virtual Machines &amp; Docker</h2>

<p>Unraid makes running VMs and containers straightforward.</p>

<h3 id="what-im-running">What I’m Running</h3>

<ul>
  <li><strong>Windows and Linux VMs</strong> (work out of the box)</li>
  <li><strong>PhotoPrism</strong>
    <ul>
      <li>Central photo backup for both iPhones and Android devices</li>
    </ul>
  </li>
  <li><strong>Pi-hole</strong>
    <ul>
      <li>Network-wide ad blocking</li>
    </ul>
  </li>
</ul>

<figure>
  <img src="/assets/images/nas-blog/pi-hole.webp" alt="Example of Pi-Hole Web GUI" width="600" />
  <figcaption>Example of Pi-Hole Web GUI</figcaption>
</figure>

<p><br /></p>

<h2 id="backup-strategy-the-important-part">Backup Strategy (The Important Part)</h2>

<p>Redundancy isn’t backup — so I built a layered approach.</p>

<h3 id="onsite-backups">Onsite Backups</h3>

<ul>
  <li>Weekly Docker container backups (configurations included)</li>
  <li>Full NAS backup using <strong>Veeam</strong> on a Windows machine</li>
</ul>

<h3 id="offsite-backups">Offsite Backups</h3>

<ul>
  <li>Installed <strong>Tailscale</strong> for VPN access</li>
  <li>Connected this NAS to another NAS at a different location</li>
  <li>Used a <strong>cron job + rsync</strong> for nightly incremental backups</li>
</ul>

<p><br /></p>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>With this setup:</p>

<ul>
  <li>Two drives can fail without data loss</li>
  <li>There’s a separate onsite backup</li>
  <li>There’s an automated offsite backup</li>
  <li>Files are accessible anywhere via Tailscale VPN</li>
  <li>Multiple ecosystems (Apple &amp; Android) sync seamlessly without subcriptions</li>
</ul>

<p>Overall, this feels like a <strong>robust, flexible, and future-proof home server</strong>. It offers far more control and capability than a typical cloud storage provider — and I learned a lot in the process.</p>

<p>If you’re comfortable with hardware and want full ownership of your data, building a home server is absolutely worth considering.</p>

<p><br /></p>

<h2 id="updates">Updates</h2>

<ul>
  <li>
    <p>After a month of use I decided to add a 1TB ssd cache drive. This allows file transfers to be done faster via the ssd and then have the files moved from the ssd cache drive to the hdds overnight.</p>
  </li>
  <li>
    <p>I added a notification setup for drive issues, backup failures etc via the Pushover app to get notifications directly to my phone if something goes wrong. This has made maintanence even easier as I don’t have to regularly check the server.</p>
  </li>
  <li>
    <p>After 2 years of operation everything is still running like a dream, no drives have needed replacing and energy consumption has been around 2.2kWh per day. I have cancelled all cloud storage subscriptions now and have not looked back.</p>
  </li>
  <li>
    <p>Losing any data on this NAS would be detrimental therefore it is not ideal for homelab activites such as cybersecurity and networking labs. 
My next build project will be a Homelab running Proxmox to facilitate cybersecurity labs, recreating vulnerabilites, exploring the effects of malware on systems and building advanced networking configurations.</p>
  </li>
</ul>]]></content><author><name></name></author><category term="nas" /><category term="unraid" /><category term="docker" /><category term="raid" /><summary type="html"><![CDATA[Cloud computing is everywhere. It’s fast, convenient, and generally affordable. So why would anyone bother building their own server to store data and files?]]></summary></entry></feed>